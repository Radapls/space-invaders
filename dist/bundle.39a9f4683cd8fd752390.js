(()=>{"use strict";class t{constructor(){this.pressed=new Set,window.addEventListener("keydown",t=>this.pressed.add(t.code)),window.addEventListener("keyup",t=>this.pressed.delete(t.code))}isPressed(t){return this.pressed.has(t)}}const s={WIDTH:50,HEIGHT:50,COLORS:["#39d353","#26a641","#006d32","#0e4429"]},e="radapls";class i{constructor(t){this.ctx=t}drawShip(t){this.ctx.drawImage(t.image,t.x,t.y,t.width,t.height)}drawBullet(t){t.destroyed||(this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,2*Math.PI),this.ctx.fillStyle="blue",this.ctx.fill(),this.ctx.closePath())}drawTargets(t){t.forEach(t=>{t.destroyed||(this.ctx.fillStyle=s.COLORS[Math.floor(Math.random()*s.COLORS.length)],this.ctx.fillRect(t.x,t.y,t.width,t.height))})}drawScore(t){this.ctx.font="bold 20px Courier New",this.ctx.fillStyle="white",this.ctx.fillText(`Score: ${t}`,8,20)}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}}const h=t=>{const s=new Image;return s.src="https://cdn-icons-png.flaticon.com/512/1985/1985828.png",{x:t.width/2,y:t.height-40-10,width:40,height:40,speed:5,image:s,destroyed:!1}},r=t=>({x:t.x+t.width/2,y:t.y,radius:5,speed:10,width:0,height:0,destroyed:!0}),a=document.getElementById("canvas");if(!a)throw new Error("Canvas no encontrado");const d=new class{constructor(s){this.canvas=s,this.targets=[],this.score=0,this.input=new t,this.loop=()=>{this.update(),this.render(),requestAnimationFrame(this.loop)},this.canvas.width=800,this.canvas.height=600,this.renderer=new i(s.getContext("2d")),this.ship=h(s),this.bullet=r(this.ship)}async init(){const t=await(async()=>{const t=`https://api.github.com/repos/${e}/${e}.github.io/commits`,s=await fetch(t,{cache:"no-store"});if(!s.ok)throw new Error(`GitHub API error: ${s.status}`);return s.json()})();this.targets=t.map(()=>(t=>({x:Math.random()*t.width,y:Math.random()*t.height/2,width:s.WIDTH,height:s.HEIGHT,destroyed:!1}))(this.canvas))}start(){requestAnimationFrame(()=>this.loop())}update(){this.handleInput(),this.moveTargets(),this.moveBullet(),this.detectCollisions()}handleInput(){this.input.isPressed("ArrowLeft")&&(this.ship.x-=5),this.input.isPressed("ArrowRight")&&(this.ship.x+=5),this.input.isPressed("ArrowUp")&&(this.ship.y-=5),this.input.isPressed("ArrowDown")&&(this.ship.y+=5),this.ship.x=Math.min(Math.max(this.ship.x,0),this.canvas.width-40),this.ship.y=Math.min(Math.max(this.ship.y,0),this.canvas.height-40),this.input.isPressed("Space")&&this.bullet.destroyed&&(this.bullet=r(this.ship))}moveTargets(){this.targets.forEach(t=>{t.destroyed||(t.y+=1,t.y>this.canvas.height&&(t.y=0,t.x=Math.random()*this.canvas.width))})}moveBullet(){this.bullet.destroyed||(this.bullet.y-=this.bullet.speed,this.bullet.y<0&&(this.bullet.destroyed=!0),this.targets.forEach(t=>{t.destroyed||this.bullet.x>t.x&&this.bullet.x<t.x+t.width&&this.bullet.y>t.y&&this.bullet.y<t.y+t.height&&(t.destroyed=!0,this.bullet.destroyed=!0,this.score++)}))}detectCollisions(){this.targets.forEach(t=>{t.destroyed||this.ship.x<t.x+t.width&&this.ship.x+40>t.x&&this.ship.y<t.y+t.height&&this.ship.y+40>t.y&&(t.destroyed=!0,this.score++)})}render(){this.renderer.clear(),this.renderer.drawShip(this.ship),this.renderer.drawBullet(this.bullet),this.renderer.drawTargets(this.targets),this.renderer.drawScore(this.score)}reset(){this.ship=h(this.canvas),this.bullet=r(this.ship),this.score=0,this.targets.forEach(t=>{t.destroyed=!1,t.x=Math.random()*this.canvas.width,t.y=Math.random()*this.canvas.height/2})}}(a),o=document.getElementById("reset-button");(async()=>{await d.init(),d.start()})(),o.addEventListener("click",()=>d.reset())})();